<!DOCTYPE html>
<html>

<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script>



        var socket = new WebSocket("wss://asdf.dy.fi:3001/ws");

        socket.onmessage = function (evt) {
            var data = JSON.parse(evt.data);

            if (data.result == "register") {
                alert(data.message);
            }
            else if (data.result == "error") {
                alert(data.message);
            }

        }

        function register(){

            if (document.getElementById("password").value != document.getElementById("password2").value) {
                alert("passwords don't match");
                return;
            }


            var jiison = { "action": "register", "name": document.getElementById("name").value, "password": document.getElementById("password").value};
            var payload = JSON.stringify(jiison);
            socket.send(payload);

        }


        $.get(
            "servers",
            {},
            function(data) {
                console.log(data["servers"]);

                data["servers"].forEach(function (item, index) {
                      console.log(item, index);
                    document.getElementById('serverList').innerHTML += item["name"] + ", Players: " + item["playerCount"] + " " + "<a href=" + item["address"] + "> Join </a>" + "<br>"
                });

            }
        );

    </script>
</head>


<body>

    <div id="register" class="register">register: <br>
        <input id="name" type="text" name="name" placeholder="Username"> <br>
        <input id="password" type="password" name="password" placeholder="Password"> <br>
        <input id="password2" type="password" name="password" placeholder="Repeat Password"> <br>

        <button onclick="register()">Register</button>
    </div>

    <br>

    <div id="serverList" class="serverList">
        Server list: <br>
    </div>

</body>
</html>
